---
// src/pages/drupal.astro
import Layout from '../layouts/BaseLayout.astro';
import { fetchDrupalContent } from '../lib/api';

// Fetch articles from Drupal
const response = await fetchDrupalContent('article', {
  'sort[sort-created][path]': 'created',
  'sort[sort-created][direction]': 'DESC',
  'page[limit]': 10
});

const articles = response.data || [];
---

<Layout title="My Drupal + Astro Site">
  <main>
    <h1>Latest Articles</h1>
    <div class="articles-grid">
      {articles.map((article) => (
        <article class="card">
          <h2>{article.attributes.title}</h2>
          <p>{article.attributes.body?.summary || article.attributes.body?.value.substring(0, 150) + '...'}</p>
          <a href={`/article/${article.id}`}>Read more</a>
        </article>
      ))}
    </div>
  </main>
</Layout>

<style>
  .articles-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
  }
  .card {
    border: 1px solid #eee;
    border-radius: 0.5rem;
    padding: 1.5rem;
    transition: transform 0.2s ease;
  }
  .card:hover {
    transform: translateY(-5px);
  }
</style>